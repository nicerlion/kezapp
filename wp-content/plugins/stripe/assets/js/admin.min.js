/*! WP Simple Pay Lite for Stripe - 2.0.12
 * https://wpsimplepay.com/
 * Copyright (c) Moonstone Media Group 2018
 * Licensed GPLv2+ */

var spAdmin={};!function(s){"use strict";var n,t;spAdmin={init:function(){n=s(document.body),t=n.find("#simpay-form-settings"),this.setupChosen(),this.addMediaFields(),this.handleMetaboxTabClick(),t.on("click.simpayTabLink",".simpay-tab-link",function(i){i.preventDefault(),spAdmin.handleInternalLinkToTabClicks(s(this))}),t.on("click.simpayImagePreview",".simpay-remove-image-preview",function(i){spAdmin.handleRemoveImagePreviewClick(i)}),t.find(".simpay-panel-field").on("click.simpaySectionToggle",".simpay-section-toggle",function(i){spAdmin.initSectionToggle(s(this))}),n.find(".simpay-button").on("click.simpayShowSpinner",function(i){spAdmin.showSpinner(s(this))}),n.find("#simpay-preview-button").on("click.simpayPreviewButton",function(i){spAdmin.handlePreviewButton(s(this),i)}),n.find("#post").on("keypress.simpaySubmitOnEnter",function(i){spAdmin.handleSubmitOnEnter(s(this))}),t.find('.simpay-multi-toggle input[type="radio"]:checked').each(function(){spAdmin.initMultiToggle(s(this))}),t.on("change.simpayMultiToggle",'.simpay-multi-toggle input[type="radio"]',function(){spAdmin.initMultiToggle(s(this))}),n.trigger("simpayAdminInit")},handleSubmitOnEnter:function(i){var e,n,t;13===(event.keyCode?event.keyCode:event.which)&&(n=(e=i.closest("form")).find("#save-post"),t=e.find("#publish"),0<n.length?n.click():t.click())},handlePreviewButton:function(i,e){var n,t;e.preventDefault(),n=(t=i.closest("form")).attr("action"),t.attr("action",i.data("action")),t.attr("target","_blank"),t.submit(),t.attr("action",n),t.attr("target","")},showSpinner:function(i){i.parent().find(".spinner").css("visibility","visible")},handleRemoveImagePreviewClick:function(i){i.preventDefault(),t.find(".simpay-image-preview-wrap").hide(),t.find("#_image_url").val("")},addMediaFields:function(){var t;s(".simpay-media-uploader").on("click",function(i){i.preventDefault(),window.simpayMediaUploaderInputField=s(this),t||(t=wp.media.frames.file_frame=wp.media({title:spGeneral.i18n.mediaTitle,button:{text:spGeneral.i18n.mediaButtonText},multiple:!1})).on("select",function(){var i=t.state().get("selection").first().toJSON(),e=window.simpayMediaUploaderInputField.prev(),n="id"===e.data("fvalue")?i.id:i.url;s(".simpay-image-preview-wrap").show(),s(".simpay-image-preview").prop("src",n),e.val(n)}),t.open()})},setupChosen:function(){var i=s(".simpay-chosen-select, .simpay-chosen-search");i.chosen({disable_search_threshold:20}),i.chosen()},handleMetaboxTabClick:function(){var i=s("ul.simpay-tabs a"),t=s("div.simpay-panel"),a=i.parents("li"),e={};i.on("click",function(i){var e=s(this).parent(),n=s(s(this).attr("href"));location.hash=s(this).attr("href"),i.preventDefault(),a.removeClass("active"),e.addClass("active"),t.addClass("simpay-panel-hidden"),n.removeClass("simpay-panel-hidden"),i.stopPropagation()}),location.hash.length&&(setTimeout(function(){window.scrollTo(0,0)},1),(e=s('ul.simpay-tabs a[href="'+location.hash+'"]')).length&&e.click())},handleInternalLinkToTabClicks:function(i){var e=i.data("show-tab");n.find("."+e+"-tab a").click()},initSectionToggle:function(i){var e=i.data("show");i.is(":checked")?i.closest(".simpay-panel-field").parent().find(e).show():i.closest(".simpay-panel-field").parent().find(e).hide()},initMultiToggle:function(i){var e=i.attr("id");i.closest(".simpay-field-radios-inline").find('input[type="radio"]').each(function(i){t.find(".toggle-"+s(this).attr("id")).hide()}),t.find(".toggle-"+e).show()}},s(document).ready(function(i){spAdmin.init()})}(jQuery);